<!-- Offcanvas Drawer -->
<div class="offcanvas offcanvas-end manage-drawer" tabindex="-1" id="dashCategoryManager" aria-labelledby="dashCategoryManagerLabel" style="width:480px;">
  <div class="offcanvas-header">
    <div class="d-flex flex-column gap-1">
      <h5 class="offcanvas-title" id="dashCategoryManagerLabel">
        <nav id="drawer-breadcrumb" class="drawer-breadcrumb"></nav>
      </h5>

      <!-- Header controls: Month (Glass) + Total -->
      <div class="small d-flex align-items-center flex-wrap gap-2">
        <span>Month:</span>

        <!-- Hidden native select (state source for JS) -->
        <select id="drawer-months" class="d-none"></select>

        <!-- Glass month control -->
        <div id="drawer-months-glass" class="glass-select">
          <button id="drawer-months-btn" class="glass-btn" type="button">
            <span id="drawer-months-label">Latest month</span>
            <svg viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M4 6l4 4 4-4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
          </button>
          <div id="drawer-months-menu" class="glass-menu" hidden>
            <button class="glass-item" data-value="">Latest month</button>
            <button class="glass-item" data-value="all">All months</button>
            <div class="glass-divider"></div>
            <div id="drawer-months-list" class="glass-list"></div>
          </div>
        </div>

        <span class="mx-1">•</span>
        <span>Total:</span>
        <span id="drawer-total" class="fw-semibold">—</span>
      </div>
    </div>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>

  <style>
    /* Basic structure */
    .drawer-breadcrumb{ display:flex; gap:.4rem; flex-wrap:wrap; align-items:center; }
    .drawer-breadcrumb .sep{ opacity:.6; }
    .drawer-tabbar{ display:flex; gap:.4rem; border-bottom:1px solid rgba(255,255,255,.08); margin:.25rem 0 .75rem; }
    .drawer-tab{ padding:.35rem .65rem; border-radius:.5rem .5rem 0 0; text-decoration:none; color:inherit; }
    .drawer-tab.active{ background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); border-bottom-color:transparent; }
    .drawer-pane{ display:none; }
    .mono{ font-variant-numeric: tabular-nums; }
    .tx-neg{ color:#d36b6b; } .tx-pos{ color:#6bd39c; }

    /* Blue pill look (used for children + cat) */
    .pill{ display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .75rem; border-radius:999px;
           border:1px solid rgba(80,150,255,.35); background:rgba(80,150,255,.08); color:#7fb2ff; line-height:1;
           text-decoration:none; cursor:pointer; transition:background .15s, border-color .15s, color .15s; }
    .pill:hover{ background:rgba(80,150,255,.14); border-color:rgba(80,150,255,.5); color:#a9caff; }
    .pill .chev{ opacity:.7; }
    .pill-row{ display:flex; flex-wrap:wrap; gap:.5rem .6rem; }
    .pill-sm{ padding:.25rem .55rem; font-size:.875rem; cursor:default; }

    /* Glass select (blurred) */
    .glass-select{ position:relative; }
    .glass-btn{
      display:inline-flex; align-items:center; gap:.4rem; padding:.25rem .6rem; border-radius:.6rem;
      border:1px solid rgba(255,255,255,.18); background:rgba(255,255,255,.10);
      backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
      color:#cfe1ff; line-height:1; box-shadow: 0 1px 0 rgba(0,0,0,.25) inset;
    }
    .glass-btn:hover{ background:rgba(255,255,255,.14); }
    .glass-menu{
      position:absolute; top:100%; left:0; margin-top:.35rem; min-width:210px; z-index:1051;
      border:1px solid rgba(255,255,255,.18); background:rgba(12,16,28,.65);
      backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
      border-radius:.75rem; padding:.35rem; box-shadow: 0 8px 32px rgba(0,0,0,.35);
    }
    .glass-item{
      display:block; width:100%; text-align:left; padding:.4rem .6rem; border-radius:.5rem; color:#d9e7ff; background:transparent; border:0;
    }
    .glass-item:hover{ background:rgba(255,255,255,.08); }
    .glass-divider{ height:1px; background:rgba(255,255,255,.15); margin:.25rem 0; }
    .glass-list{ max-height:260px; overflow:auto; }
  </style>

  <div class="offcanvas-body">
    <!-- Tabs -->
    <div class="drawer-tabbar">
      <a href="#" class="drawer-tab active" data-tab="overview">Overview</a>
      <a href="#" class="drawer-tab" data-tab="keywords">Keywords</a>
      <a href="#" class="drawer-tab" data-tab="actions">Actions</a>
    </div>

    <!-- Children -->
    <div class="mb-2">
      <div class="fw-semibold mb-1">Children:</div>
      <div id="drawer-children" class="pill-row"></div>
    </div>

    <!-- Overview -->
    <div class="drawer-pane" data-pane="overview" style="display:block;">
      <div class="table-responsive">
        <table class="table table-sm align-middle mb-0">
          <thead>
            <tr>
              <th class="w-25">Date</th>
              <th>Description</th>
              <th class="text-end w-25">Amount</th>
              <th class="w-25">Cat</th>
            </tr>
          </thead>
          <tbody id="drawer-tx-body">
            <tr><td colspan="4" class="text-muted">Loading…</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Keywords -->
    <div class="drawer-pane" data-pane="keywords">
      <div class="d-flex align-items-center gap-2 mb-2">
        <input id="kw-add-input" class="form-control form-control-sm" placeholder="Add keyword…" />
        <button id="kw-add-btn" class="btn btn-sm btn-primary">Add</button>
      </div>
      <div id="kw-list" class="d-flex flex-wrap gap-2 small"></div>
    </div>

    <!-- Actions -->
    <div class="drawer-pane" data-pane="actions">
      <!-- your existing buttons/listeners can live here; JS exposes runAction(kind) -->
      <div class="small text-muted">Use <code>[data-action]</code> buttons and hook them via <code>runAction(kind)</code> in drawer.js.</div>
    </div>
  </div>
</div>
