/* =========================================================
   NEON TECH — global theme tokens, components, utilities
   (polished drawer + transactions table)
   ========================================================= */

/* --- Tokens --- */
:root{
  --page-bg-1:#0b1220;
  --page-bg-2:#0f172a;
  --glow-1:#243b55;
  --glow-2:#1b3a6b;

  /* Signature ink */
  --accent-ink:#9ecbff;
  --text: var(--accent-ink);
  --muted: var(--accent-ink);

  --card-bg:rgba(255,255,255,.045);
  --card-border:rgba(255,255,255,.10);
  --hair:rgba(255,255,255,.08);

  --thead-bg:rgba(255,255,255,.06);
  --thead-fg: var(--accent-ink);

  --table-head-bg: var(--thead-bg);
  --table-head-fg: var(--thead-fg);

  --plotly-grid: rgba(158,203,255,.11);

  --scroll-track: transparent;
  --scroll-thumb: color-mix(in oklab, var(--accent-ink) 58%, transparent);
  --scroll-thumb-hover: color-mix(in oklab, var(--accent-ink) 82%, transparent);
  --scroll-border: rgba(255,255,255,.22);
}

/* --- Page background --- */
html.theme-dark, body.theme-dark {
  background:
    radial-gradient(1200px 700px at -10% -10%, var(--glow-1) 0%, transparent 45%),
    radial-gradient(900px 600px at 110% 0%, var(--glow-2) 0%, transparent 40%),
    linear-gradient(180deg, var(--page-bg-2) 0%, var(--page-bg-1) 100%) !important;
  color: var(--text);
}

/* --- Navbar --- */
.navbar {
  background: var(--card-bg) !important;
  border-bottom: 1px solid var(--card-border) !important;
  backdrop-filter: saturate(120%) blur(6px);
}
.navbar, .navbar .navbar-brand, .navbar .nav-link, .navbar .navbar-text {
  color: var(--text) !important;
}
.navbar .nav-link.active, .navbar .nav-link:hover { color: #ffffff !important; }

/* --- Cards, panels, modals, offcanvas --- */
.card, .stat-card, .panel, .list-group, .offcanvas, .modal-content {
  background: var(--card-bg) !important;
  border: 1px solid var(--card-border) !important;
  color: var(--text);
  box-shadow:
    0 12px 28px rgba(0,0,0,.35),
    inset 0 1px 0 rgba(255,255,255,.05);
  border-radius: 16px;
  backdrop-filter: saturate(120%) blur(4px);
}
.card .card-header,
.stat-card .card-header,
.panel .card-header{
  background: var(--thead-bg) !important;
  color: var(--text) !important;
  border-bottom: 1px solid var(--hair) !important;
  font-weight: 700;
  letter-spacing: .2px;
}

/* --- Forms & buttons --- */
.form-control, .form-select, .input-group-text, .btn-outline-secondary, .btn-outline-light {
  background: rgba(255,255,255,.06) !important;
  border-color: var(--card-border) !important;
  color: var(--text) !important;
}
.form-control::placeholder { color: color-mix(in oklab, var(--accent-ink) 70%, transparent); }
.btn-outline-light { color: var(--text) !important; }
.btn-primary { background: #2563eb; border-color: #2563eb; }

/* --- Table shell --- */
.table-responsive{
  border:1px solid var(--card-border);
  border-radius:14px;
  background:var(--card-bg);
  box-shadow:0 8px 24px rgba(0,0,0,.30), inset 0 1px 0 rgba(255,255,255,.04);
  overflow:auto;
  position: relative;
  scrollbar-gutter: stable both-edges;
}

/* --- Table colors --- */
.theme-dark .table{
  --bs-table-bg: transparent;
  --bs-table-color: var(--text);
  --bs-table-border-color: var(--hair);
  --bs-table-striped-bg: rgba(255,255,255,.02);
  --bs-table-striped-color: var(--text);
  --bs-table-hover-bg: rgba(255,255,255,.05);
  --bs-table-hover-color: var(--text);
}
.theme-dark .table > :not(caption) > * > *{
  background-color: transparent !important;
  box-shadow: none !important;
}

/* --- Floating tables (unified shell) --- */
.table-floating,
.table-floating .table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  color:var(--text);
  background:transparent;
}
.table-floating > :not(caption) > thead > tr > th,
.table-floating .table > :not(caption) > thead > tr > th{
  border-bottom:1px solid var(--hair);
  font-weight:700; letter-spacing:.2px;
}
.table-floating > :not(caption) > tbody > tr > td,
.table-floating .table > :not(caption) > tbody > tr > td{
  border-top:1px solid var(--hair);
  vertical-align:middle;
}
.table-floating > :not(caption) > tbody > tr:nth-child(odd),
.table-floating .table > :not(caption) > tbody > tr:nth-child(odd){
  background:rgba(255,255,255,.015);
}
.table-floating > :not(caption) > tbody > tr:hover,
.table-floating .table > :not(caption) > tbody > tr:hover{
  background:rgba(255,255,255,.05);
}

/* --- Frosted sticky table heads (global) --- */
.table thead th,
.table thead td{
  background: var(--thead-bg) !important;
  color: var(--table-head-fg, var(--text)) !important;
  border-bottom:1px solid var(--hair) !important;
}
.table thead th:first-child { border-top-left-radius: 12px; }
.table thead th:last-child  { border-top-right-radius: 12px; }

.table-responsive thead{
  position: sticky;
  top: 0;
  z-index: 4;
}
.table thead th{
  backdrop-filter: saturate(120%) blur(6px);
  -webkit-backdrop-filter: saturate(120%) blur(6px);
  background:
    linear-gradient(
      180deg,
      color-mix(in oklab, var(--thead-bg) 85%, transparent) 0%,
      color-mix(in oklab, var(--thead-bg) 70%, transparent) 100%
    ) !important;
  border-bottom: 1px solid var(--hair) !important;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.06),
    0 10px 18px rgba(2, 6, 23, .25);
  will-change: backdrop-filter;
  padding: .65rem .9rem;
  font-weight: 700;
  letter-spacing: .2px;
}

/* --- Utilities --- */
canvas { background: transparent !important; }
.muted { color: var(--muted) !important; }
.mono { font-variant-numeric: tabular-nums; }
.tx-neg { color:#c0392b; font-weight:600; }
.tx-pos { color:#1e7e34; font-weight:600; }

/* --- Global scrollbars --- */

/* Firefox – page */
html.theme-dark, body.theme-dark {
  scrollbar-width: thin;
  scrollbar-color: var(--scroll-thumb) var(--scroll-track);
}
/* Firefox – common inner scrollers */
.table-responsive, .offcanvas, .offcanvas-body, .modal, .modal-body {
  scrollbar-width: thin;
  scrollbar-color: var(--scroll-thumb) var(--scroll-track);
}

/* WebKit – page */
html.theme-dark::-webkit-scrollbar,
body.theme-dark::-webkit-scrollbar{ width:12px; height:12px; }
html.theme-dark::-webkit-scrollbar-track,
body.theme-dark::-webkit-scrollbar-track{ background: var(--scroll-track); }
html.theme-dark::-webkit-scrollbar-thumb,
body.theme-dark::-webkit-scrollbar-thumb{
  background: var(--scroll-thumb);
  border-radius: 999px;
  border: 3px solid transparent;
  background-clip: padding-box;
  box-shadow:
    0 2px 8px rgba(0,0,0,.35),
    inset 0 0 0 1px var(--scroll-border);
}
html.theme-dark::-webkit-scrollbar-thumb:hover,
body.theme-dark::-webkit-scrollbar-thumb:hover{ background: var(--scroll-thumb-hover); }
html.theme-dark::-webkit-scrollbar-corner,
body.theme-dark::-webkit-scrollbar-corner{ background: transparent; }

/* WebKit – inner scrollers */
.table-responsive::-webkit-scrollbar,
.offcanvas::-webkit-scrollbar,
.offcanvas-body::-webkit-scrollbar,
.modal::-webkit-scrollbar,
.modal-body::-webkit-scrollbar{ width:12px; height:12px; }
.table-responsive::-webkit-scrollbar-track,
.offcanvas::-webkit-scrollbar-track,
.offcanvas-body::-webkit-scrollbar-track,
.modal::-webkit-scrollbar-track,
.modal-body::-webkit-scrollbar-track{ background: var(--scroll-track); }
.table-responsive::-webkit-scrollbar-thumb,
.offcanvas::-webkit-scrollbar-thumb,
.offcanvas-body::-webkit-scrollbar-thumb,
.modal::-webkit-scrollbar-thumb,
.modal-body::-webkit-scrollbar-thumb{
  background: var(--scroll-thumb);
  border-radius: 999px;
  border: 3px solid transparent;
  background-clip: padding-box;
  box-shadow:
    0 2px 8px rgba(0,0,0,.35),
    inset 0 0 0 1px var(--scroll-border);
}
.table-responsive::-webkit-scrollbar-thumb:hover,
.offcanvas::-webkit-scrollbar-thumb:hover,
.offcanvas-body::-webkit-scrollbar-thumb:hover,
.modal::-webkit-scrollbar-thumb:hover,
.modal-body::-webkit-scrollbar-thumb:hover{ background: var(--scroll-thumb-hover); }
.table-responsive::-webkit-scrollbar-corner,
.offcanvas::-webkit-scrollbar-corner,
.offcanvas-body::-webkit-scrollbar-corner,
.modal::-webkit-scrollbar-corner,
.modal-body::-webkit-scrollbar-corner{ background: transparent; }

/* --- Goals page left-align only (kept) --- */
body[data-route="/goals"] .table th,
body[data-route="/goals"] .table td{ text-align:left !important; }
body[data-route="/goals"] .table .text-end,
body[data-route="/goals"] .table .text-center,
body[data-route="/goals"] .table [style*="text-align: right"],
body[data-route="/goals"] .table [style*="text-align:right"],
body[data-route="/goals"] .table [style*="text-align: center"],
body[data-route="/goals"] .table [style*="text-align:center"]{ text-align:left !important; }
body[data-route="/goals"] .table .form-control,
body[data-route="/goals"] .table .input-group .form-control{ text-align:left !important; }

/* =========================================================
   Drawer (global, glassy, sticky) — ENHANCED & POLISHED
   ========================================================= */

/* Backdrop blur */
.offcanvas-backdrop.show{
  background: rgba(8,12,20,.28) !important;
  -webkit-backdrop-filter: blur(14px) saturate(140%);
  backdrop-filter: blur(14px) saturate(140%);
}

/* Shell */
.manage-drawer.offcanvas{
  background: var(--card-bg) !important;
  border-left: 1px solid var(--card-border) !important;
  color: var(--text);
  box-shadow:
    0 22px 48px rgba(0,0,0,.50),
    inset 0 1px 0 rgba(255,255,255,.05);
}

/* Header: strong glass (no see-through messiness) */
.manage-drawer .offcanvas-header{
  position: sticky;
  top: 0;
  z-index: 6;
  background:
    linear-gradient(
      180deg,
      color-mix(in oklab, var(--thead-bg) 95%, transparent) 0%,
      color-mix(in oklab, var(--thead-bg) 84%, transparent) 100%
    ) !important;
  -webkit-backdrop-filter: saturate(130%) blur(12px);
  backdrop-filter: saturate(130%) blur(12px);
  border-bottom: 1px solid var(--hair) !important;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.06),
    0 14px 22px rgba(2,6,23,.30);
}

/* Close button polish */
.manage-drawer .btn-close{
  filter: invert(1) grayscale(1) contrast(90%);
  opacity: .85;
}
.manage-drawer .btn-close:hover{ opacity: 1; }

/* Signature blue text everywhere inside drawer */
.manage-drawer, .manage-drawer *{ color: var(--text); }

/* ---------- CHILDREN: floating, no pills, no bullets, no white ---------- */
.manage-drawer .drawer-children-wrap{
  margin-top:.35rem;
  padding:10px 14px;
  border:1px solid var(--card-border);
  border-radius:14px;
  background:
    linear-gradient(
      180deg,
      color-mix(in oklab, var(--thead-bg) 90%, transparent) 0%,
      color-mix(in oklab, var(--thead-bg) 78%, transparent) 100%
    );
  -webkit-backdrop-filter: saturate(120%) blur(10px);
  backdrop-filter: saturate(120%) blur(10px);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.05),
    0 10px 18px rgba(2,6,23,.22);
}
.manage-drawer .drawer-children-list{
  list-style:none;
  margin:0; padding:0;
  display:flex; flex-wrap:wrap; gap:8px 22px;
}
.manage-drawer .drawer-children-list li{ margin:0; padding:0; }
.manage-drawer .drawer-children-list a{
  text-decoration:none;
  font-weight:800;
  letter-spacing:.2px;
  line-height:1.35;
  /* no background/white ever */
  background: transparent !important;
  border: none !important;
}
.manage-drawer .drawer-children-list a:hover{
  text-decoration: underline;     /* clean hover */
  background: transparent !important;
}

/* ---------- SUBHEADER / PINS (sticky glass) ---------- */
.manage-drawer .drawer-sub{
  position: sticky;
  top: var(--drawer-header-h, 56px);
  z-index: 5;
  padding:.5rem .75rem;
  background:
    linear-gradient(
      180deg,
      color-mix(in oklab, var(--thead-bg) 90%, transparent) 0%,
      color-mix(in oklab, var(--thead-bg) 78%, transparent) 100%
    ) !important;
  -webkit-backdrop-filter: saturate(120%) blur(10px);
  backdrop-filter: saturate(120%) blur(10px);
  border-bottom: 1px solid var(--hair);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.05),
    0 12px 20px rgba(2,6,23,.24);
}
.manage-drawer .drawer-value{
  font-weight:800;
  color: var(--accent-ink);
  text-shadow: 0 0 10px rgba(158,203,255,.28);
}

/* ---------- TRANSACTIONS TABLE (tidy & polished) ---------- */
.manage-drawer .table-responsive{
  --drawer-table-xpad: 14px;
  padding-left: var(--drawer-table-xpad);
  padding-right: var(--drawer-table-xpad);
}

.manage-drawer #drawer-tx{
  border-collapse: separate;
  border-spacing: 0;
}
.manage-drawer #drawer-tx th,
.manage-drawer #drawer-tx td{
  padding:.65rem .9rem;
  border-color: var(--hair) !important;
}
.manage-drawer #drawer-tx tbody tr{
  transition: background-color .12s ease, transform .06s ease;
}
.manage-drawer #drawer-tx tbody tr:hover{
  /* subtle bluish hover, no white */
  background: color-mix(in oklab, var(--accent-ink) 10%, transparent);
}
.manage-drawer #drawer-tx tbody tr:active{
  transform: translateY(0px) scale(.997);
}

/* Stickier, stronger glass for THEAD inside drawer */
.manage-drawer .table-responsive thead{
  position: sticky;
  top: 0;
  z-index: 4;
}
.manage-drawer #drawer-tx thead th{
  backdrop-filter: saturate(140%) blur(10px);
  -webkit-backdrop-filter: saturate(140%) blur(10px);
  background:
    linear-gradient(
      180deg,
      color-mix(in oklab, var(--thead-bg) 96%, transparent) 0%,
      color-mix(in oklab, var(--thead-bg) 86%, transparent) 100%
    ) !important;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.07),
    0 12px 20px rgba(2,6,23,.30);
}

/* Month divider: sticky + glass; bleeds left/right to align flush */
.manage-drawer #drawer-tx .month-divider{ background: transparent !important; }
.manage-drawer #drawer-tx .month-divider > td{
  position: sticky;
  top: var(--drawer-thead-h, 42px);
  z-index: 3;

  margin-left: calc(-1 * var(--drawer-table-xpad));
  margin-right: calc(-1 * var(--drawer-table-xpad));
  padding-left: calc(var(--drawer-table-xpad) + .9rem);
  padding-right: calc(var(--drawer-table-xpad) + .9rem);

  backdrop-filter: saturate(130%) blur(10px);
  -webkit-backdrop-filter: saturate(130%) blur(10px);
  background:
    linear-gradient(
      180deg,
      color-mix(in oklab, var(--thead-bg) 94%, transparent) 0%,
      color-mix(in oklab, var(--thead-bg) 82%, transparent) 100%
    ) !important;
  border-top: 1px solid var(--hair);
  border-bottom: 1px solid var(--hair);
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.06),
    0 10px 18px rgba(2,6,23,.26);
  font-weight:700; letter-spacing:.2px;
}
.manage-drawer #drawer-tx tbody > .month-divider:first-child > td{
  border-top-left-radius:12px;
  border-top-right-radius:12px;
}

/* ---------- No-white interactions anywhere in drawer ---------- */
.manage-drawer a,
.manage-drawer button,
.manage-drawer .btn,
.manage-drawer .drawer-children-list a{
  background: transparent !important;
  color: var(--text) !important;
  box-shadow: none !important;
}

/* =========================================================
   Micro-interaction toolkit (used by Category Builder & Drawer)
   ========================================================= */
@keyframes bt-fade-slide-in {
  from { opacity:0; transform: translateY(6px) scale(.995); }
  to   { opacity:1; transform: translateY(0) scale(1); }
}
.bt-reveal { animation: bt-fade-slide-in .22s ease-out; }
